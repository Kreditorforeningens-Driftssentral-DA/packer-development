#cloud-config
# ===============================================================
#   GENERATED BY TERRAFORM
# ===============================================================
---
autoinstall:
  version: 1
  early-commands:
    - systemctl stop ssh
  refresh-installer:
    update: true
  ssh:
    install-server: true
    allow-pw: true
  storage:
    layout:
      name: direct
    swap:
      size: 0
  user-data:
    locale: ${input_locale}
    timezone: ${timezone}
    users:
      - name: ${local_username}
        passwd: ${local_password}
        groups: ["adm", "cdrom", "sudo"]
        sudo: ALL=(ALL) NOPASSWD:ALL
        shell: /bin/bash
        lock-passwd: false
  late-commands:
    - sed -i 's/^#*\(send dhcp-client-identifier\).*$/\1 = hardware;/' /target/etc/dhcp/dhclient.conf
    - 'sed -i "s/dhcp4: true/&\n      dhcp-identifier: mac/" /target/etc/netplan/00-installer-config.yaml'
...
# ===============================================================
#   GENERATED BY TERRAFORM
# ===============================================================